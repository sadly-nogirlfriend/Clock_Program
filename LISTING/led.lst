C51 COMPILER V9.54   LED                                                                   10/01/2024 15:57:44 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE LED
OBJECT MODULE PLACED IN ..\OUTPUT\led.obj
COMPILER INVOKED BY: E:\Keil_C51\C51\BIN\C51.EXE ..\SOURCE\led.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\SOURCE) DEBUG OBJECT
                    -EXTEND PRINT(..\LISTING\led.lst) TABS(2) OBJECT(..\OUTPUT\led.obj)

line level    source

   1          /*******************************************************
   2          file.name : led.c
   3          version : 1.1
   4          description : 该文件存放了一些用于显示led和led数码管的
   5          相关函数。
   6          *******************************************************/
   7          
   8          #include "led.h"
   9          #include <reg51.h>
  10          
  11          // led段码表,存放在rom中
  12          unsigned char code leddata[]={ 
  13                          0xC0,  //"0"
  14                          0xF9,  //"1"
  15                          0xA4,  //"2"
  16                          0xB0,  //"3"
  17                          0x99,  //"4"
  18                          0x92,  //"5"
  19                          0x82,  //"6"
  20                          0xF8,  //"7"
  21                          0x80,  //"8"
  22                          0x90,  //"9"
  23                          0x88,  //"A"
  24                          0x83,  //"B"
  25                          0xC6,  //"C"
  26                          0xA1,  //"D"
  27                          0x86,  //"E"
  28                          0x8E,  //"F"
  29                          0x89,  //"H"
  30                          0xC7,  //"L"
  31                          0xC8,  //"n"
  32                          0xC1,  //"u"
  33                          0x8C,  //"P"
  34                          0xA3,  //"o"
  35                          0xBF,  //"-"
  36                          0xFF,  //熄灭
  37                          0x91   //"y"
  38                                   };
  39          
  40          // 延时X毫秒的函数
  41          void DelayXms(unsigned int xms)
  42          {
  43   1      
  44   1        unsigned int i,j;
  45   1        for(i=xms;i>0;i--)
  46   1        {
  47   2          for(j=0;j<124;j++);
  48   2        }
  49   1      }
  50          
  51          // 用于让数码管静态显示
  52          // display_screen(input,signature)
  53          // input为需要输入的字符，signature为选位
  54          // 该函数的显示过程已经进行了消影处理
C51 COMPILER V9.54   LED                                                                   10/01/2024 15:57:44 PAGE 2   

  55          void display_screen(unsigned char input,unsigned char signature)
  56          {
  57   1        unsigned char temp = 0xf1;
  58   1        // 设置选位
  59   1        if(signature>=0&&signature<=3)
  60   1          GPIO_PLACE = temp << signature;
  61   1        
  62   1        
  63   1        if((input>='0')&&(input<='9'))
  64   1          GPIO_DIG = leddata[input-'0'];
  65   1        else if((input>='A')&&(input<='F'))
  66   1          GPIO_DIG = leddata[input-'A'+10];
  67   1        else if(input=='H')
  68   1          GPIO_DIG = leddata[16];
  69   1        else if(input=='L')
  70   1          GPIO_DIG = leddata[17];
  71   1        else if(input=='n')
  72   1          GPIO_DIG = leddata[18];
  73   1        else if(input=='u')
  74   1          GPIO_DIG = leddata[19];
  75   1        else if(input=='p')
  76   1          GPIO_DIG = leddata[20];
  77   1        else if(input=='o')
  78   1          GPIO_DIG = leddata[21];
  79   1        else if(input=='-')
  80   1          GPIO_DIG = leddata[22];
  81   1        else if(input=='*') // 表示熄灭
  82   1          GPIO_DIG = leddata[23];
  83   1        else if(input=='y')
  84   1          GPIO_DIG = leddata[24];
  85   1        DelayXms(5);
  86   1        
  87   1        // 消影
  88   1        GPIO_DIG = 0xff;
  89   1        DelayXms(5);
  90   1      }
  91          
  92          // 用于让数码管在xms内动态显示一组数组
  93          void display_str(unsigned char *input,unsigned int xms)
  94          {
  95   1        unsigned char i = 0;
  96   1        for(i=0;i<xms/40;i++)
  97   1        {
  98   2          display_screen(input[0],0);
  99   2          display_screen(input[1],1);
 100   2          display_screen(input[2],2);
 101   2          display_screen(input[3],3);
 102   2        }
 103   1      }
 104          
 105          // 用于让数码管动态显示一次数组，一次的显示时长约为40ms
 106          void display_str_once(unsigned char *input)
 107          {
 108   1        display_screen(input[0],0);
 109   1        display_screen(input[1],1);
 110   1        display_screen(input[2],2);
 111   1        display_screen(input[3],3);
 112   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    336    ----
C51 COMPILER V9.54   LED                                                                   10/01/2024 15:57:44 PAGE 3   

   CONSTANT SIZE    =     25    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
